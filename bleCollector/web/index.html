<!DOCTYPE html>
<html>
<head>
    <title>BLE Collector</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style type="text/css">
        #my_txt {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 14px;
            color: blue;
        }
    </style>
</head>
<body>
    <h1>Hello, world</h1>
    <p id="my_txt"></p>
    <button onclick="buttonClicked()">OK</button>
    <p id="my_loc"></p>
    <button onclick="getLocation()">Where am I</button>
    <script>
        console.log("Hello, world");
        var my_txt = document.getElementById("my_txt");
        my_txt.innerHTML = "Hello, JavaScript";
        var my_loc = document.getElementById("my_loc");
        function getLocation() {
            navigator.geolocation.getCurrentPosition(
                (pos) => {
                    my_loc.innerHTML = "Lat" + pos.coords.latitude + " Lon" + pos.coords.longitude;
                    fetch("/api?lat="+pos.coords.latitude+"&lon="+pos.coords.longitude)
                    .then(function(response) {
                        return response.json();
                    })
                    .then(function(data) {
                        console.log(data);
                        my_txt.innerHTML = data.my_txt;
                    });
                },
                (err) => {
                    my_loc.innerHTML = "Error: " + err.message;
                }
            );
        }
        function buttonClicked() {
            fetch("/api").then(function(response) {
                return response.json();
            }).then(function(data) {
                console.log(data);
                my_txt.innerHTML = data.my_txt;
            });
        }

    </script>
</body>
</html>